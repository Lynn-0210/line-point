{\rtf1\ansi\ansicpg950\cocoartf2639
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\fswiss\fcharset0 Helvetica;\f1\fnil\fcharset136 PingFangTC-Regular;\f2\fnil\fcharset0 AppleColorEmoji;
}
{\colortbl;\red255\green255\blue255;}
{\*\expandedcolortbl;;}
\paperw11900\paperh16840\margl1440\margr1440\vieww11520\viewh8400\viewkind0
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural\partightenfactor0

\f0\fs24 \cf0 <!DOCTYPE html>\
<html>\
<head>\
  <meta charset="UTF-8">\
  <meta name="viewport" content="width=device-width, initial-scale=1.0">\
  <title>
\f1 \'a4\'57\'bd\'75\'b6\'b0\'c2\'49\'b4\'ab\'c2\'a7\'aa\'ab
\f0 </title>\
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>\
  <style>\
    body \{ font-family: sans-serif; text-align: center; padding: 20px; background-color: #f4f7f9; color: #333; \}\
    .card \{ background: white; padding: 30px 20px; border-radius: 20px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); max-width: 400px; margin: 0 auto; \}\
    #photo \{ width: 80px; height: 80px; border-radius: 50%; border: 3px solid #007bff; display: none; margin: 0 auto 15px; \}\
    #points \{ font-size: 64px; color: #007bff; font-weight: bold; margin: 10px 0; \}\
    .btn \{ padding: 15px; border: none; border-radius: 50px; font-size: 18px; width: 100%; cursor: pointer; font-weight: bold; margin-top: 15px; color: white; \}\
    #btnLogin \{ background-color: #007bff; \}\
    .btn-upload \{ background-color: #28a745; position: relative; \}\
    input[type=file] \{ position: absolute; left: 0; top: 0; opacity: 0; width: 100%; height: 100%; cursor: pointer; \}\
    select \{ width: 100%; padding: 12px; font-size: 16px; border-radius: 10px; border: 2px solid #ddd; margin-bottom: 15px; \}\
    .hint \{ font-size: 13px; color: #666; background: #e9ecef; padding: 15px; border-radius: 10px; text-align: left; line-height: 1.6; \}\
    #status \{ margin-top: 20px; font-size: 14px; color: #17a2b8; font-weight: bold; \}\
    #preview \{ max-width: 100%; border-radius: 10px; margin-top: 15px; display: none; \}\
  </style>\
</head>\
<body>\
\
  <div class="card">\
    <h2 id="title">
\f1 \'be\'c7\'ad\'fb\'b6\'b0\'c2\'49\'a8\'74\'b2\'ce
\f0 </h2>\
\
    <div id="loginArea">\
        <button id="btnLogin" class="btn" onclick="liff.login()">LINE 
\f1 \'b1\'62\'b8\'b9\'b5\'6e\'a4\'4a
\f0 </button>\
    </div>\
\
    <div id="memberArea" style="display:none;">\
        <img id="photo" src="">\
        <h2 id="name"></h2>\
        <p style="margin:0; color:#888;">
\f1 \'a5\'d8\'ab\'65\'b2\'d6\'bf\'6e\'bf\'6e\'a4\'c0
\f0 </p>\
        <div id="points">0</div>\
        \
        <select id="taskSelect" onchange="updatePointsDisplay()">\
            <option value="event">
\f2 \uc0\u55356 \u57314 
\f0  
\f1 \'b9\'ea\'c5\'e9\'bd\'d2\'b5\'7b\'c3\'b1\'a8\'ec
\f0 </option>\
            <option value="regular">
\f2 \uc0\u55357 \u56507 
\f0  
\f1 \'bd\'75\'a4\'57\'be\'c7\'b2\'df\'ac\'f6\'bf\'fd
\f0 </option>\
        </select>\
\
        <div class="hint">\
          <b>
\f2 \uc0\u55356 \u57119 
\f0  
\f1 \'b6\'b0\'c2\'49\'b3\'57\'ab\'68\'a1\'47
\f0 </b><br>\
          1. 
\f1 \'ba\'49\'b9\'cf\'bb\'dd\'a5\'5d\'a7\'74\'c3\'f6\'c1\'e4\'a6\'72\'a1\'47
\f0 <b>
\f1 \'a4\'57\'bd\'75\'b6\'b0\'c2\'49\'b4\'ab\'c2\'a7\'aa\'ab
\f0 </b><br>\
          2. 
\f1 \'ba\'49\'b9\'cf\'bb\'dd\'c5\'e3\'a5\'dc
\f0 <b>
\f1 \'a4\'b5\'a4\'e9\'a4\'e9\'b4\'c1
\f0  (2026/01/02)</b>
\f1 \'a1\'43
\f0 <br>\
          3. 
\f1 \'b8\'67
\f0  AI 
\f1 \'bc\'66\'ae\'d6\'b3\'71\'b9\'4c\'a7\'59\'a5\'69\'c0\'f2\'b1\'6f
\f0  10 
\f1 \'c2\'49\'a1\'49
\f0 \
        </div>\
        \
        <div class="btn btn-upload">\
          
\f1 \'a4\'57\'b6\'c7\'ba\'49\'b9\'cf\'bb\'e2\'bf\'6e\'a4\'c0
\f0 \
          <input type="file" accept="image/*" onchange="handleFile(this)">\
        </div>\
        \
        <img id="preview" src="">\
        <p id="status"></p>\
    </div>\
  </div>\
\
  <script>\
    // 
\f2 \uc0\u55357 \u56628 
\f0  
\f1 \'bd\'d0\'ad\'d7\'a7\'ef\'a4\'55\'ad\'b1\'b3\'6f\'a8\'e2\'ad\'d3\'a6\'61\'a4\'e8
\f0 \
    const MY_LIFF_ID = "
\f1 \'b3\'6f\'b8\'cc\'b6\'f1\'a4\'4a\'a7\'41\'aa\'ba
\f0 _LIFF_ID"; \
    const GAS_API_URL = "
\f1 \'b3\'6f\'b8\'cc\'b6\'f1\'a4\'4a\'a7\'41\'aa\'ba
\f0 _GAS_
\f1 \'b3\'a1\'b8\'70\'ba\'f4\'a7\'7d
\f0 "; \
\
    let userProfile = null;\
    let currentPointsData = \{ event: 0, regular: 0 \};\
\
    window.onload = async function() \{\
      try \{\
        await liff.init(\{ liffId: MY_LIFF_ID \});\
        if (liff.isLoggedIn()) \{\
          liff.getProfile().then(profile => \{\
            userProfile = profile;\
            document.getElementById('loginArea').style.display = "none";\
            document.getElementById('memberArea').style.display = "block";\
            document.getElementById('name').innerText = profile.displayName + " 
\f1 \'a6\'50\'be\'c7
\f0 ";\
            if(profile.pictureUrl) \{\
               document.getElementById('photo').src = profile.pictureUrl;\
               document.getElementById('photo').style.display = "block";\
            \}\
            refreshPoints();\
          \});\
        \}\
      \} catch (err) \{ console.error(err); \}\
    \};\
\
    function refreshPoints() \{\
      fetch(`$\{GAS_API_URL\}?action=getPoints&userId=$\{userProfile.userId\}`)\
        .then(res => res.json())\
        .then(data => \{\
            currentPointsData = data;\
            updatePointsDisplay();\
        \});\
    \}\
\
    function updatePointsDisplay() \{\
        const type = document.getElementById('taskSelect').value;\
        document.getElementById('points').innerText = (type === 'event') ? currentPointsData.event : currentPointsData.regular;\
    \}\
\
    function handleFile(input) \{\
      if (input.files && input.files[0]) \{\
        const status = document.getElementById('status');\
        status.innerText = "
\f2 \uc0\u55357 \u56960 
\f0  AI 
\f1 \'a5\'bf\'a6\'62\'ae\'d6\'b9\'ef\'c3\'f6\'c1\'e4\'a6\'72\'bb\'50\'a4\'e9\'b4\'c1
\f0 ...";\
        \
        const reader = new FileReader();\
        reader.onload = function(e) \{\
            const img = new Image();\
            img.src = e.target.result;\
            img.onload = function() \{\
                const canvas = document.createElement('canvas');\
                const maxWidth = 1000;\
                const scale = maxWidth / img.width;\
                canvas.width = maxWidth;\
                canvas.height = img.height * scale;\
                canvas.getContext('2d').drawImage(img, 0, 0, canvas.width, canvas.height);\
                const base64 = canvas.toDataURL('image/jpeg', 0.8);\
                document.getElementById('preview').src = base64;\
                document.getElementById('preview').style.display = "block";\
                upload(base64);\
            \}\
        \}\
        reader.readAsDataURL(input.files[0]);\
      \}\
    \}\
\
    function upload(base64) \{\
        fetch(GAS_API_URL, \{\
            method: 'POST',\
            body: JSON.stringify(\{\
                image: base64,\
                userId: userProfile.userId,\
                displayName: userProfile.displayName,\
                category: document.getElementById('taskSelect').value\
            \})\
        \})\
        .then(res => res.json())\
        .then(res => \{\
            if (res.status === "SUCCESS") \{\
                alert("
\f2 \uc0\u55356 \u57225 
\f0  
\f1 \'ae\'a5\'b3\'df\'a1\'49\'bc\'66\'ae\'d6\'b3\'71\'b9\'4c\'a1\'41\'c0\'f2\'b1\'6f
\f0  " + res.added + " 
\f1 \'c2\'49
\f0 ");\
                currentPointsData = res.current;\
                updatePointsDisplay();\
                document.getElementById('status').innerText = "
\f2 \uc0\u9989 
\f0  
\f1 \'bb\'e2\'a8\'fa\'a6\'a8\'a5\'5c
\f0 ";\
            \} else \{\
                alert("
\f2 \uc0\u10060 
\f0  
\f1 \'bc\'66\'ae\'d6\'a5\'a2\'b1\'d1\'a1\'47
\f0 \\n" + res.message);\
                document.getElementById('status').innerText = "
\f2 \uc0\u10060 
\f0  
\f1 \'a5\'a2\'b1\'d1
\f0 ";\
            \}\
        \});\
    \}\
  </script>\
</body>\
</html>}